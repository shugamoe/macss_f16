---
title: "STAT 374 | HW1 "
author: "Julian McClellan"
date: "April 23, 2016"
output:
  pdf_document:
    toc: true
    highlight: zenburn
    fig_height: 3.5
---
## 1. Computing and plotting with R(15 points)

### (a)



```{r, tidy=TRUE, tidy.opts=list(width.cutoff=60)}
sample_size = c(seq(1,200))
sim = function(part_b = FALSE, ssize = sample_size, sig = 1, b = 100) {
  rv = c()
  for(n in sample_size){
    stat_n =  c()
    
    for(rep in (1:b)) {
      mew_n = mean(rnorm(n, 1, sig))
      if(part_b) {
        stat_b = sqrt(n) * (mew_n - 1) # Z
      } else {
        stat_b = (mew_n - 1)^2 # The MSE
      }
      stat_n = append(stat_n, stat_b)
    }
    
    if(part_b) {
      stat_rv = stat_n
    } else {
      stat_rv = mean(stat_n)
    }
    rv = append(rv, stat_rv)
  }
  if(part_b) {
    x = seq(-3, 3, .01)
    f = dnorm(x, sd = sig)
    plot(density(rv), main = "Z")
    lines(x,f,'l',col='red')
  } else {
    # Normal scale plot
    plot(sample_size, rv, ylab = "")
    lines(sample_size, (sig^2) / sample_size, col = "red")
    title(expression(paste(frac(sigma^2, n), "vs. Empirical MSE")), line = -2) 
    
    # Log Log Plot
    plot(sample_size, log = "xy", rv, ylab = "log 1", xlab = "log sample size")
    lines(sample_size, (sig^2) / sample_size, col = "red")
    title(expression(paste("log(", frac(sigma^2, n), ") ", "vs. log(Empirical MSE)")), line = -2)
  }
  
}
```

### (b)
```{r, tidy=TRUE, tidy.opts=list(width.cutoff=60)}
zs = sim(TRUE)
plot(sample_size, zs)
```

